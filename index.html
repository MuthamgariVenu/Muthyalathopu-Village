<!doctype html>
<html lang="te">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>‡∞Æ‡±Å‡∞§‡±ç‡∞Ø‡∞æ‡∞≤‡±ãopu ‚Äî Dashboard</title>

  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>

  <style>
    :root{ --bg:#f8fafc; --card:#fff; --muted:#6b7280; --text:#0f172a; --accent:#f97316; }
    .moon{ --bg:#07102a; --card:rgba(255,255,255,0.04); --muted:#cbd5e1; --text:#e6f0ff; --accent:#fb923c;}
    body{ background:var(--bg); color:var(--text); transition:.22s; font-family:ui-sans-serif,system-ui,-apple-system,"Segoe UI",Roboto,Arial;}
    header{ position:fixed; top:0; left:0; right:0; z-index:40; background:var(--card); box-shadow:0 2px 6px rgba(0,0,0,0.06); }
    main{ max-width:1100px; margin:0 auto; padding:96px 16px 40px; } /* padding-top to avoid header overlap */
    .card{ background:var(--card); border-radius:10px; padding:14px; box-shadow:0 1px 4px rgba(2,6,23,0.04); }
    .muted{ color:var(--muted); }
    .ticker{ white-space:nowrap; overflow:hidden; }
    .ticker__move{ display:inline-block; padding-left:100%; animation:ticker 55s linear infinite; }
    @keyframes ticker{ 0%{transform:translateX(0);}100%{transform:translateX(-100%);} }
    a.link{ color:var(--accent); text-decoration:none; }
  </style>
</head>
<body id="body">

<!-- HEADER -->
<header>
  <div class="max-w-6xl mx-auto flex items-center justify-between p-4 gap-3">
    <div class="flex items-center gap-3">
      <img src="images/logo.png" alt="logo" class="w-10 h-10 rounded-full object-cover" onerror="this.style.display='none'">
      <!-- Header logo + Telugu title -->
<div class="flex items-center gap-3">
  <img src="images/logo.png" alt="logo" class="w-10 h-10 rounded-full object-cover" onerror="this.style.display='none'">
  <div>
    <div class="text-xl font-semibold telugu">‡∞Æ‡±Å‡∞§‡±ç‡∞Ø‡∞æ‡∞≤‡∞≤‡±ã‡∞™‡±Å ‡∞ó‡±ç‡∞∞‡∞æ‡∞Æ‡∞æ‡∞®‡∞ø‡∞ï‡∞ø ‡∞∏‡±ç‡∞µ‡∞æ‡∞ó‡∞§‡∞Ç</div>
    <div class="text-sm muted telugu">‡∞Æ‡∞® ‡∞ä‡∞∞‡∞ø ‡∞∏‡∞Æ‡∞æ‡∞ö‡∞æ‡∞∞‡∞Ç ‚Äî ‡∞§‡±Ü‡∞≤‡±Å‡∞ó‡±Å</div>
  </div>
</div>


    <div class="flex items-center gap-3">
      <a href="about.html" class="px-3 py-2 rounded card telugu">‡∞ó‡±ç‡∞∞‡∞æ‡∞Æ‡∞Ç ‡∞ó‡±Å‡∞∞‡∞ø‡∞Ç‡∞ö‡∞ø</a>
      <button id="themeToggle" class="px-3 py-2 rounded card">üåô</button>
    </div>
  </div>
</header>

<main>
  <!-- Flash news -->
  <section class="card mb-4">
    <div class="flex items-center gap-4">
      <div class="font-semibold telugu accent">üì¢ ‡∞§‡∞æ‡∞ú‡∞æ ‡∞µ‡∞æ‡∞∞‡±ç‡∞§‡∞≤‡±Å</div>
      <div id="flashTicker" class="ticker flex-1 muted telugu">‡∞≤‡±ã‡∞°‡±ç ‡∞Ö‡∞µ‡±Å‡∞§‡±Å‡∞Ç‡∞¶‡∞ø...</div>
    </div>
  </section>

  <!-- 1. Basic Info (directly after header as requested) -->
  <section id="basic" class="card mb-4">
    <h3 class="font-semibold telugu">‡∞ó‡±ç‡∞∞‡∞æ‡∞Æ‡∞Ç ‚Äî ‡∞Æ‡±å‡∞≤‡∞ø‡∞ï ‡∞∏‡∞Æ‡∞æ‡∞ö‡∞æ‡∞∞‡∞Ç</h3>
    <div id="basicInfoContent" class="muted mt-2 text-sm">‡∞≤‡±ã‡∞°‡±ç ‡∞Ö‡∞µ‡±Å‡∞§‡±Å‡∞Ç‡∞¶‡∞ø...</div>
  </section>

  <!-- Water & Electricity (left) and Helpline (right) -->
  <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
    <div class="card">
      <h4 class="font-semibold telugu">‡∞®‡±Ä‡∞∞‡±Å & ‡∞µ‡∞ø‡∞¶‡±ç‡∞Ø‡±Å‡∞§‡±ç ‡∞∏‡∞Æ‡∞æ‡∞ö‡∞æ‡∞∞‡∞Ç</h4>
      <div id="waterContent" class="muted text-sm mt-2">‡∞≤‡±ã‡∞°‡±ç ‡∞Ö‡∞µ‡±Å‡∞§‡±Å‡∞Ç‡∞¶‡∞ø...</div>
    </div>

    <div class="card">
      <h4 class="font-semibold telugu">‡∞Ö‡∞§‡±ç‡∞Ø‡∞æ‡∞µ‡∞∂‡±ç‡∞Ø‡∞ï ‡∞∏‡∞π‡∞æ‡∞Ø‡∞Ç & ‡∞π‡±Ü‡∞≤‡±ç‡∞™‡±ç‚Äå‡∞≤‡±à‡∞®‡±ç</h4>
      <div id="helplineContent" class="muted text-sm mt-2">‡∞≤‡±ã‡∞°‡±ç ‡∞Ö‡∞µ‡±Å‡∞§‡±Å‡∞Ç‡∞¶‡∞ø...</div>
    </div>
  </div>

  <!-- Peddalu carousel (left wide) + Sachivalayam card (right) -->
  <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-4">
    <div class="md:col-span-2 card">
      <h4 class="font-semibold telugu">‡∞ó‡±ç‡∞∞‡∞æ‡∞Æ ‡∞™‡±Ü‡∞¶‡±ç‡∞¶‡∞≤‡±Å (‡∞™‡±Ü‡∞¶‡±ç‡∞¶/‡∞Æ‡∞ß‡±ç‡∞Ø/‡∞ö‡∞ø‡∞®‡±ç‡∞®)</h4>
      <div id="peddaluCarousel" class="mt-3"></div>
      <div class="flex gap-2 mt-3">
        <button id="prevP" class="px-3 py-1 rounded card telugu">‡∞Æ‡±Å‡∞Ç‡∞¶‡±Å‡∞ï‡±Å</button>
        <button id="nextP" class="px-3 py-1 rounded card telugu">‡∞§‡∞∞‡±ç‡∞µ‡∞æ‡∞§</button>
      </div>
    </div>

    <div class="card">
      <h4 class="font-semibold telugu">‡∞∏‡∞ö‡∞ø‡∞µ‡∞æ‡∞≤‡∞Ø‡∞Ç ‡∞∏‡∞Æ‡∞æ‡∞ö‡∞æ‡∞∞‡∞Ç</h4>
      <div id="sachivalayamCard" class="mt-2 text-sm telugu">
        <div><strong>‡∞∏‡∞ö‡∞ø‡∞µ‡∞æ‡∞≤‡∞Ø ‡∞Ö‡∞ß‡∞ø‡∞ï‡∞æ‡∞∞‡∞ø:</strong> <span id="secName">‚Äî</span></div>
        <div>‡∞´‡±ã‡∞®‡±ç: <a id="secPhone" class="link" href="#">‚Äî</a></div>
        <div class="mt-2"><strong>VRO:</strong> <span id="vroName">‚Äî</span></div>
        <div>‡∞´‡±ã‡∞®‡±ç: <a id="vroPhone" class="link" href="#">‚Äî</a></div>
      </div>
    </div>
  </div>

  <!-- Schemes placeholder -->
  <section class="card mb-4">
    <h4 class="font-semibold telugu">‡∞™‡∞•‡∞ï‡∞æ‡∞≤‡±Å</h4>
    <div class="muted text-sm mt-2">‡∞™‡∞•‡∞ï‡∞æ‡∞≤ ‡∞∏‡∞Æ‡∞∞‡±Ä ‡∞á‡∞ï‡±ç‡∞ï‡∞° ‡∞ï‡∞®‡∞ø‡∞™‡∞ø‡∞∏‡±ç‡∞§‡±Å‡∞Ç‡∞¶‡∞ø. (Schemes page ‡∞§‡±ç‡∞µ‡∞∞‡∞≤‡±ã)</div>
  </section>

  <!-- Footer small -->
  <footer class="muted text-sm text-center mt-6">¬© Muthyalathopu Village</footer>
</main>

<script>
/* Theme toggle */
const themeToggle = document.getElementById('themeToggle');
function applyTheme(moon){ document.documentElement.classList.toggle('moon', !!moon); localStorage.setItem('muthya_moon', moon ? '1':'0'); themeToggle.textContent = moon ? 'üåû':'üåô'; }
applyTheme(localStorage.getItem('muthya_moon') === '1');
themeToggle.addEventListener('click', ()=> applyTheme(!document.documentElement.classList.contains('moon')));

/* CSV loader */
function loadCSV(path){
  return new Promise((res,rej)=>{
    Papa.parse(path, { download:true, header:true, skipEmptyLines:true, complete: r=> res(r.data), error: e=> rej(e) });
  });
}

/* flash */
async function renderFlash(){
  const el = document.getElementById('flashTicker');
  try{
    const rows = await loadCSV('Data/flash_news.csv');
    if(!rows.length) throw 'no';
    const parts = rows.map(r=> (r.date?`[ ${r.date} ] `:'') + (r.title||'') + ' ‚Äî ' + (r.description||''));
    const mover = document.createElement('div'); mover.className='ticker__move telugu'; mover.textContent = parts.join(' ‚ö´ ');
    el.innerHTML=''; el.appendChild(mover);
  }catch(e){
    el.innerHTML = '<div class="telugu muted">‡∞§‡∞æ‡∞ú‡∞æ ‡∞µ‡∞æ‡∞∞‡±ç‡∞§‡∞≤‡±Å ‡∞≤‡±á‡∞µ‡±Å</div>';
  }
}

/* basic info */
async function renderBasicInfo(){
  const el = document.getElementById('basicInfoContent');
  try{
    const rows = await loadCSV('Data/village_info.csv'); const r = rows[0];
    el.innerHTML = `
      <div><strong>‡∞ó‡±ç‡∞∞‡∞æ‡∞Æ‡∞Ç:</strong> ${r.village_name_tel||'‚Äî'} ${r.village_name_en? '('+r.village_name_en+')':''}</div>
      <div><strong>‡∞Æ‡∞Ç‡∞°‡∞≤‡∞Ç:</strong> ${r.mandal||'‚Äî'}</div>
      <div><strong>‡∞ú‡∞ø‡∞≤‡±ç‡∞≤‡∞æ:</strong> ${r.district||'‚Äî'}</div>
      <div><strong>‡∞∏‡∞Ç‡∞ñ‡±ç‡∞Ø‡∞≤‡±Å:</strong> ‡∞ú‡∞®‡∞æ‡∞≠‡∞æ ‡∞Æ‡±ä‡∞§‡±ç‡∞§‡∞Ç ${r.pop_total||'‚Äî'} (‡∞™‡±Å‡∞∞‡±Å‡∞∑‡±Å‡∞≤‡±Å ${r.pop_male||'‚Äî'}, ‡∞Æ‡∞π‡∞ø‡∞≥‡∞≤‡±Å ${r.pop_female||'‚Äî'})</div>
      <div><strong>‡∞á‡∞≥‡±ç‡∞≥ ‡∞∏‡∞Ç‡∞ñ‡±ç‡∞Ø:</strong> ${r.total_houses||'‚Äî'}</div>
      <div><strong>‡∞™‡±ç‡∞∞‡∞ß‡∞æ‡∞® ‡∞ï‡∞æ‡∞∞‡±ç‡∞Ø‡∞ï‡∞≤‡∞æ‡∞™‡∞æ‡∞≤‡±Å:</strong> ${r.main_occupations||'‚Äî'}</div>
    `;
  }catch(e){
    el.innerHTML = `<div class="muted telugu">Village info not available. Edit Data/village_info.csv</div>`;
  }
}

/* water & helpline */
async function renderWater(){
  const el = document.getElementById('waterContent');
  try{
    const rows = await loadCSV('Data/water_elec.csv');
    if(!rows.length) throw 'no';
    el.innerHTML = rows.map(r=> `<div><strong>${r.type||'‚Äî'}:</strong> ${r.detail||'‚Äî'}</div>`).join('');
  }catch(e){ el.innerHTML = '<div class="muted telugu">‡∞®‡±Ä‡∞∞‡±Å/‡∞µ‡∞ø‡∞¶‡±ç‡∞Ø‡±Å‡∞§‡±ç ‡∞µ‡∞ø‡∞µ‡∞∞‡∞æ‡∞≤‡±Å ‡∞≤‡±á‡∞µ‡±Å</div>'; }
}
async function renderHelpline(){
  const el = document.getElementById('helplineContent');
  try{
    const rows = await loadCSV('Data/helpline.csv');
    if(!rows.length) throw 'no';
    el.innerHTML = '<ul class="list-disc pl-5">'+ rows.map(r=> `<li><strong>${r.role||r.name||'‚Äî'}:</strong> <a class="link" href="tel:${r.phone||''}">${r.phone||'‚Äî'}</a></li>`).join('') + '</ul>';
  }catch(e){ el.innerHTML = '<div class="muted telugu">‡∞π‡±Ü‡∞≤‡±ç‡∞™‡±ç‚Äå‡∞≤‡±à‡∞®‡±ç ‡∞∏‡∞Æ‡∞æ‡∞ö‡∞æ‡∞∞‡∞Ç ‡∞≤‡±á‡∞¶‡±Å</div>'; }
}

/* peddalu carousel */
let pidx=0, pslides=[];
async function renderPeddalu(){
  const wrap = document.getElementById('peddaluCarousel');
  try{ const rows = await loadCSV('Data/village_peddalu.csv'); pslides = rows; }
  catch(e){ pslides = []; }
  if(!pslides.length){ wrap.innerHTML='<div class="muted telugu p-4">‡∞™‡±Ü‡∞¶‡±ç‡∞¶‡∞≤ ‡∞µ‡∞ø‡∞µ‡∞∞‡∞æ‡∞≤‡±Å ‡∞≤‡±á‡∞µ‡±Å</div>'; return; }
  function show(i){
    pidx = (i + pslides.length) % pslides.length; const it=pslides[pidx];
    wrap.innerHTML = `<div class="flex items-center gap-4">
      <div class="w-20 h-20 rounded-full overflow-hidden bg-gray-100"><img src="${it.photo_url||'images/pedda.jpg'}" alt="" class="w-full h-full object-cover"></div>
      <div><div class="font-semibold telugu">${it.role||''}</div><div class="text-lg font-bold telugu">${it.name||''}</div><div class="muted telugu mt-1">${it.note||''}</div></div>
    </div>`;
  }
  document.getElementById('prevP').onclick = ()=> show(pidx-1);
  document.getElementById('nextP').onclick = ()=> show(pidx+1);
  show(0);
}

/* sachivalayam static (or from CSV if you want) */
function fillSachivalayam(){
  document.getElementById('secName').textContent = '‡∞é‡∞Ç. ‡∞∏‡±Ä‡∞§‡∞æ‡∞∞‡∞æ‡∞Ç';
  document.getElementById('secPhone').textContent = '+91 98765 43210'; document.getElementById('secPhone').href='tel:+919876543210';
  document.getElementById('vroName').textContent = '‡∞¨‡∞ø. ‡∞∞‡∞µ‡∞ø‡∞ï‡∞æ‡∞Ç‡∞§‡±ç'; document.getElementById('vroPhone').textContent = '+91 99887 66554'; document.getElementById('vroPhone').href='tel:+919988766554';
}

/* init */
renderFlash(); renderBasicInfo(); renderWater(); renderHelpline(); renderPeddalu(); fillSachivalayam();
</script>
</body>
</html>
