<!doctype html>
<html lang="te">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>‡∞Æ‡±Å‡∞§‡±ç‡∞Ø‡∞æ‡∞≤‡∞§‡±ã‡∞™‡±Å ‡∞ó‡±ç‡∞∞‡∞æ‡∞Æ ‡∞¶‡∞∞‡±ç‡∞∂‡∞ø‡∞®‡∞ø</title>

  <!-- Tailwind -->
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- PapaParse -->
  <script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>

  <style>
    .ticker { white-space: nowrap; overflow: hidden; }
    .ticker__move { display:inline-block; padding-left:100%; animation: ticker 55s linear infinite; }
    @keyframes ticker { 0% { transform: translateX(0);} 100% { transform: translateX(-100%);} }
    .sidebar-backdrop { background: rgba(0,0,0,0.45); }
    .card-img { object-fit: cover; }
  </style>
</head>
<body class="bg-gray-50 text-gray-900">

  <!-- HEADER -->
  <header class="sticky top-0 z-40 bg-white shadow">
    <div class="max-w-6xl mx-auto px-4 py-3 flex items-center justify-between gap-3">
      <div class="flex items-center gap-3">
        <button id="menuToggle" class="sm:hidden p-2 rounded bg-gray-100">‚ò∞</button>
        <img src="images/logo.png" alt="Logo" class="w-10 h-10 rounded-full object-cover" onerror="this.style.display='none'">
        <h1 class="text-lg sm:text-2xl font-bold telugu">‡∞Æ‡±Å‡∞§‡±ç‡∞Ø‡∞æ‡∞≤‡∞§‡±ã‡∞™‡±Å ‡∞ó‡±ç‡∞∞‡∞æ‡∞Æ ‡∞¶‡∞∞‡±ç‡∞∂‡∞ø‡∞®‡∞ø</h1>
      </div>
    </div>

    <!-- Desktop modules -->
    <nav class="hidden sm:block max-w-6xl mx-auto px-4 pb-3">
      <div class="grid grid-cols-3 gap-4">
        <a id="aboutBtn" class="bg-white rounded-2xl p-5 text-center block shadow hover:bg-green-50 transition">
          <div class="text-lg font-semibold telugu">‡∞ó‡±ç‡∞∞‡∞æ‡∞Æ‡∞Ç ‡∞ó‡±Å‡∞∞‡∞ø‡∞Ç‡∞ö‡∞ø</div>
        </a>
        <a id="schemesBtn" class="bg-white rounded-2xl p-5 text-center block shadow hover:bg-green-50 transition">
          <div class="text-lg font-semibold telugu">‡∞™‡∞•‡∞ï‡∞æ‡∞≤‡±Å</div>
        </a>
        <a id="adminBtn" class="bg-white rounded-2xl p-5 text-center block shadow hover:bg-green-50 transition">
          <div class="text-lg font-semibold telugu">‡∞®‡∞ø‡∞∞‡±ç‡∞µ‡∞æ‡∞π‡∞ï‡±Å‡∞≤‡±Å</div>
        </a>
      </div>
    </nav>
  </header>

  <!-- MOBILE SIDEBAR -->
  <div id="sidebar" class="fixed inset-0 z-50 hidden">
    <div id="sidebarBackdrop" class="absolute inset-0 sidebar-backdrop" onclick="toggleSidebar(false)"></div>
    <aside class="relative z-10 w-72 h-full bg-white p-4 overflow-auto">
      <div class="flex items-center justify-between mb-4">
        <div class="flex items-center gap-3">
          <img src="images/logo.png" alt="Logo" class="w-10 h-10 rounded-full object-cover" onerror="this.style.display='none'">
          <div>
            <div class="text-base font-semibold telugu">‡∞Æ‡±Å‡∞§‡±ç‡∞Ø‡∞æ‡∞≤‡∞§‡±ã‡∞™‡±Å</div>
            <div class="text-sm text-gray-500 telugu">‡∞Æ‡±Ü‡∞®‡±Ç</div>
          </div>
        </div>
        <button onclick="toggleSidebar(false)" class="p-2 rounded">‚úï</button>
      </div>

      <nav class="space-y-3">
        <a onclick="toggleSidebar(false); aboutScroll()" class="block p-3 rounded bg-gray-100 telugu">‡∞ó‡±ç‡∞∞‡∞æ‡∞Æ‡∞Ç ‡∞ó‡±Å‡∞∞‡∞ø‡∞Ç‡∞ö‡∞ø</a>
        <a onclick="toggleSidebar(false); schemesScroll()" class="block p-3 rounded bg-gray-100 telugu">‡∞™‡∞•‡∞ï‡∞æ‡∞≤‡±Å</a>
        <a onclick="toggleSidebar(false); adminScroll()" class="block p-3 rounded bg-gray-100 telugu">‡∞®‡∞ø‡∞∞‡±ç‡∞µ‡∞æ‡∞π‡∞ï‡±Å‡∞≤‡±Å</a>
      </nav>
    </aside>
  </div>

  <!-- MAIN -->
  <main class="max-w-6xl mx-auto p-4 space-y-6">

    <!-- Flash News -->
    <section id="flashSection" class="bg-orange-50 rounded p-3 border-l-4 border-orange-400">
      <div class="flex items-center gap-3">
        <div class="text-orange-600 font-semibold telugu">üì¢ ‡∞§‡∞æ‡∞ú‡∞æ ‡∞µ‡∞æ‡∞∞‡±ç‡∞§‡∞≤‡±Å</div>
        <div id="flashTicker" class="flex-1 ticker text-sm text-orange-800 telugu"></div>
      </div>
    </section>

    <!-- Peddalu + Sachivalayam (two-column) -->
    <section id="peddaluSection" class="bg-white rounded shadow p-3">
      <h2 class="text-lg font-semibold telugu mb-2">‡∞ó‡±ç‡∞∞‡∞æ‡∞Æ ‡∞™‡±Ü‡∞¶‡±ç‡∞¶‡∞≤ ‡∞µ‡∞ø‡∞µ‡∞∞‡∞æ‡∞≤‡±Å</h2>

      <div class="grid grid-cols-1 lg:grid-cols-3 gap-4">
        <!-- Left: carousel (takes 2/3 width on large screens) -->
        <div class="lg:col-span-2 bg-white rounded p-2">
          <div id="peddaluCarousel" class="overflow-hidden rounded"></div>

          <div class="flex gap-2 justify-center mt-3">
            <button id="prevP" class="px-3 py-1 rounded bg-gray-100 telugu">‡∞Æ‡±Å‡∞Ç‡∞¶‡±Å‡∞ï‡±Å</button>
            <button id="nextP" class="px-3 py-1 rounded bg-gray-100 telugu">‡∞§‡∞∞‡±ç‡∞µ‡∞æ‡∞§</button>
          </div>
        </div>

        <!-- Right: static Sachivalayam card (non-sliding) -->
        <div class="bg-white rounded p-4 shadow">
          <h3 class="text-md font-semibold telugu mb-2">‡∞∏‡∞ö‡∞ø‡∞µ‡∞æ‡∞≤‡∞Ø‡∞Ç ‡∞∏‡∞Æ‡∞æ‡∞ö‡∞æ‡∞∞‡∞Ç</h3>

          <!-- You can edit the below static details -->
          <div class="space-y-2 text-sm telugu">
            <div><span class="font-semibold">‡∞∏‡∞ö‡∞ø‡∞µ‡∞æ‡∞≤‡∞Ø ‡∞Ö‡∞ß‡∞ø‡∞ï‡∞æ‡∞∞‡∞ø (Secretary):</span><br> ‡∞é‡∞Ç. ‡∞∏‡±Ä‡∞§‡∞æ‡∞∞‡∞æ‡∞Ç</div>
            <div><span class="font-semibold">‡∞∏‡∞ö‡∞ø‡∞µ‡∞æ‡∞≤‡∞Ø‡∞Ç ‡∞ï‡∞æ‡∞Ç‡∞ü‡∞æ‡∞ï‡±ç‡∞ü‡±ç:</span><br> +91 98765 43210</div>
            <div><span class="font-semibold">VRO (‡∞µ‡∞ø‡∞≤‡±á‡∞ú‡±ç ‡∞∞‡∞ø‡∞ï‡∞æ‡∞∞‡±ç‡∞°‡±ç ‡∞Ö‡∞ß‡∞ø‡∞ï‡∞æ‡∞∞‡∞ø):</span><br> ‡∞¨‡∞ø. ‡∞∞‡∞µ‡∞ø‡∞ï‡∞æ‡∞Ç‡∞§‡±ç</div>
            <div><span class="font-semibold">VRO ‡∞ï‡∞æ‡∞Ç‡∞ü‡∞æ‡∞ï‡±ç‡∞ü‡±ç:</span><br> +91 99887 66554</div>
            <div><span class="font-semibold">‡∞ó‡±ç‡∞∞‡∞æ‡∞Æ ‡∞™‡∞Ç‡∞ö‡∞æ‡∞Ø‡∞ø‡∞§‡±Ä ‡∞ï‡∞æ‡∞∞‡±ç‡∞Ø‡∞æ‡∞≤‡∞Ø‡∞Ç:</span><br> ‡∞Æ‡±Å‡∞§‡±ç‡∞Ø‡∞æ‡∞≤‡∞§‡±ã‡∞™‡±Å, ‡∞§‡±ã‡∞ü‡∞™‡∞≤‡±ç‡∞≤‡∞ø‡∞ó‡±Ç‡∞°‡±Ç‡∞∞‡±Å ‡∞Æ‡∞Ç‡∞°‡∞≤‡±ç</div>
            <div><span class="font-semibold">‡∞™‡∞π‡∞Ç‡∞ö‡∞æ‡∞Ø‡∞§‡±ç ‡∞¶‡∞´‡∞∞‡±Å‡∞ï‡±Å ‡∞∏‡∞Æ‡±Ä‡∞™ ‡∞∏‡∞Æ‡∞Ø‡∞Ç:</span><br> ‡∞∏‡±ã‡∞Æ‚Äì‡∞∂‡±Å‡∞ï‡±ç‡∞∞: 10:00 AM ‚Äì 5:00 PM</div>
          </div>

          <div class="mt-4">
            <button id="callSecretary" class="w-full bg-green-600 text-white py-2 rounded telugu">‡∞∏‡∞ö‡∞ø‡∞µ‡∞æ‡∞≤‡∞Ø‡∞æ‡∞®‡∞ø‡∞ï‡∞ø ‡∞ï‡∞æ‡∞≤‡±ç ‡∞ö‡±á‡∞Ø‡∞Ç‡∞°‡∞ø</button>
          </div>
        </div>
      </div>
    </section>

    <!-- Photos -->
    <section id="photosSection" class="bg-white rounded shadow p-3">
      <h2 class="text-lg font-semibold telugu mb-2">‡∞Æ‡∞æ ‡∞ó‡±ç‡∞∞‡∞æ‡∞Æ‡∞™‡±Å ‡∞ö‡∞ø‡∞§‡±ç‡∞∞‡∞æ‡∞≤‡±Å</h2>
      <div id="photosGrid" class="grid grid-cols-2 sm:grid-cols-3 gap-3"></div>
    </section>

    <!-- Map (Google embed) -->
    <section id="mapSection" class="bg-white rounded shadow p-3">
      <h2 class="text-lg font-semibold telugu mb-2">‡∞ó‡±ç‡∞∞‡∞æ‡∞Æ ‡∞Æ‡±ç‡∞Ø‡∞æ‡∞™‡±ç</h2>
      <div style="width:100%;height:420px;border-radius:8px;overflow:hidden;">
        <iframe width="100%" height="100%" frameborder="0" style="border:0"
          src="https://www.google.com/maps?q=Mutyalathopupalem%2C%20Nellore%2C%20Andhra%20Pradesh&output=embed" allowfullscreen="" loading="lazy"></iframe>
      </div>
      <div class="text-sm text-gray-500 mt-2 telugu">Google Maps ‡∞¶‡±ç‡∞µ‡∞æ‡∞∞‡∞æ satellite ‡∞≤‡±á‡∞¶‡∞æ road view ‡∞≤‡±ã ‡∞ó‡±ç‡∞∞‡∞æ‡∞Æ‡∞æ‡∞®‡±ç‡∞®‡∞ø ‡∞ö‡±Ç‡∞°‡∞Ç‡∞°‡∞ø.</div>
    </section>

  </main>

  <!-- Image modal -->
  <div id="imgModal" class="fixed inset-0 hidden items-center justify-center z-50">
    <div class="absolute inset-0 bg-black/60"></div>
    <div class="relative z-10 max-w-3xl mx-auto p-4">
      <div class="bg-white rounded shadow-lg overflow-hidden">
        <div class="p-2 text-right"><button id="closeModal" class="px-2 telugu">‡∞Æ‡±Ç‡∞∏‡∞ø‡∞µ‡±á‡∞Ø‡∞ø</button></div>
        <div class="p-2"><img id="modalImg" src="" alt="photo" class="w-full h-96 object-contain" /></div>
      </div>
    </div>
  </div>

<script>
/* Sidebar */
const sidebarEl = document.getElementById('sidebar');
function toggleSidebar(show){ sidebarEl.classList.toggle('hidden', !show); }
document.getElementById('menuToggle').addEventListener('click', ()=> toggleSidebar(true));

/* CSV loader */
function loadCSV(path){
  return new Promise((resolve,reject)=>{
    Papa.parse(path, { download:true, header:true, skipEmptyLines:true,
      complete: (res)=> resolve(res.data), error: (err)=> reject(err)
    });
  });
}

/* FLASH NEWS */
async function renderFlash(){
  const ticker = document.getElementById('flashTicker');
  let items = [];
  try { items = await loadCSV('Data/flash_news.csv'); } catch(e){ items = []; }
  if(!items.length){ ticker.innerHTML = '<div class="text-sm text-orange-800 telugu">‡∞§‡∞æ‡∞ú‡∞æ ‡∞µ‡∞æ‡∞∞‡±ç‡∞§‡∞≤‡±Å ‡∞≤‡±á‡∞µ‡±Å</div>'; return; }
  const parts = items.map(it => {
    const date = it.date ? `[ ${it.date} ] ` : '';
    return `${date}${it.title || ''} ‚Äî ${it.description || ''}`;
  });
  const mover = document.createElement('div');
  mover.className = 'ticker__move text-orange-800 telugu';
  mover.textContent = parts.join('   ‚ö´   ');
  ticker.innerHTML = ''; ticker.appendChild(mover);
}

/* PEDDALU carousel (role + note; name removed) */
let idx = 0, slides = [], timer;
async function renderPeddalu(){
  const wrap = document.getElementById('peddaluCarousel');
  let items = [];
  try { items = await loadCSV('Data/village_peddalu.csv'); } catch(e){ items = []; }
  slides = items || [];
  if(!slides.length){ wrap.innerHTML = '<div class="p-4 telugu text-gray-500">‡∞™‡±Ü‡∞¶‡±ç‡∞¶‡∞≤ ‡∞µ‡∞ø‡∞µ‡∞∞‡∞æ‡∞≤‡±Å ‡∞≤‡±á‡∞µ‡±Å</div>'; return; }

  function show(i){
    idx = (i + slides.length) % slides.length;
    const it = slides[idx];
    // Show only role + note (no name)
    wrap.innerHTML = `
      <div class="flex flex-col sm:flex-row items-center gap-4 p-4">
        <div class="w-28 h-28 rounded-full overflow-hidden bg-gray-100">
          <img src="${it.photo_url || 'images/pedda.jpg'}" alt="${it.role||''}" class="w-full h-full object-cover">
        </div>
        <div>
          <div class="text-lg font-semibold telugu">${it.role || ''}</div>
          <div class="text-sm text-gray-500 telugu mt-1">${it.note || ''}</div>
        </div>
      </div>
    `;
  }

  document.getElementById('prevP').onclick = ()=>{ show(idx-1); resetAuto(); };
  document.getElementById('nextP').onclick = ()=>{ show(idx+1); resetAuto(); };

  show(0);
  function auto(){ timer = setInterval(()=> show(idx+1), 4500); }
  function resetAuto(){ clearInterval(timer); auto(); }
  auto();
}

/* PHOTOS */
async function renderPhotos(){
  const grid = document.getElementById('photosGrid');
  let items = [];
  try { items = await loadCSV('Data/village_photos.csv'); } catch(e){ items = []; }
  if(!items.length){ grid.innerHTML = '<div class="p-4 telugu text-gray-500">‡∞´‡±ã‡∞ü‡±ã‡∞≤‡±Å ‡∞≤‡±á‡∞µ‡±Å</div>'; return; }
  grid.innerHTML = '';
  items.forEach(it=>{
    const img = document.createElement('img');
    img.src = it.image_url || it.image || '';
    img.alt = it.title || '';
    img.className = 'w-full h-40 object-cover rounded cursor-pointer';
    img.addEventListener('click', ()=> openModal(img.src));
    grid.appendChild(img);
  });
}

/* Modal */
function openModal(src){
  document.getElementById('modalImg').src = src;
  document.getElementById('imgModal').classList.remove('hidden');
  document.getElementById('imgModal').classList.add('flex');
}
document.getElementById('closeModal').addEventListener('click', ()=>{
  document.getElementById('imgModal').classList.add('hidden');
  document.getElementById('imgModal').classList.remove('flex');
});

/* Static Sachivalayam Call Button handler */
document.getElementById('callSecretary')?.addEventListener('click', ()=> {
  // static number listed above; opens dialer on mobile
  window.location.href = 'tel:+919876543210';
});

/* Init */
renderFlash();
renderPeddalu();
renderPhotos();

/* Scroll nav */
function aboutScroll(){ window.scrollTo({top:200,behavior:'smooth'}); }
function schemesScroll(){ window.scrollTo({top:480,behavior:'smooth'}); }
function adminScroll(){ window.scrollTo({top:760,behavior:'smooth'}); }
document.getElementById('aboutBtn').addEventListener('click', aboutScroll);
document.getElementById('schemesBtn').addEventListener('click', schemesScroll);
document.getElementById('adminBtn').addEventListener('click', adminScroll);
</script>
</body>
</html>
